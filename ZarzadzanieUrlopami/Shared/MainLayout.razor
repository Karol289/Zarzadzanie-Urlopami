@inherits LayoutComponentBase
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager

<div class="container">

    <div class="sidebar">
        <NavMenu />
    </div>

    <div class="mainbar">
     <div class="header">
    <p class="title">Zarządzanie Urlopami</p>

    <AuthorizeView>
        <Authorized Context="authContext">
            <div class="user-info fade-in">
                 
               
                     <img src="images/person.png" alt="Avatar" class="login-im">

                     <div class="right-user-info">
                          <div>
                    Zalogowano jako:
                            @{
                                var imie = authContext.User.FindFirst("Imie")?.Value;
                                var wyswietlonaNazwa = !string.IsNullOrWhiteSpace(imie)
                                    ? imie
                                    : authContext.User.Identity?.Name;
                            }
                    <strong>@wyswietlonaNazwa</strong>
                </div>
                <div>
                    Rola:
                    <strong>@authContext.User.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value</strong>
                </div>
                <button class="logout-btn" @onclick="Logout">
                    <span class="oi oi-account-logout"></span> Wyloguj
                </button>
               </div>
            </div>
        </Authorized>
    </AuthorizeView>
</div>

        <div class="decorative-bar"></div>

        <div class="main">
            <div class="circle circle-1"></div>
            <div class="circle circle-2"></div>
            <div class="circle circle-3"></div>
            <div class="ring ring-1"></div>
            <div class="ring ring-2"></div>
            <div class="ring ring-3"></div>
            @Body
        </div>

        <footer class="footer">
          
        </footer>
    </div>
</div>

@code {
    private void Logout()
    {
        if (AuthenticationStateProvider is CustomAuthenticationStateProvider auth)
        {
            auth.MarkUserAsLoggedOut();
        }

        NavigationManager.NavigateTo("/login", forceLoad: true);
    }
}
